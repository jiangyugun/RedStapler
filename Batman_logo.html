<!DOCTYPE html>
<html>
  <head>
    <meta charset=UTF-8 />
    <link rel="stylesheet" type="text/css" href="css/Batman_logo.css" />
  </head>
  <body>
    <script src="build_threejs/three.min.js"></script>
    <script src="js/loaders/GLTFLoader.js"></script>
    <script src="js/controls/OrbitControls.js"></script>
    <script src="build_postprocessing/postprocessing.min.js"></script>
    <script>
      let scene, camera, renderer, composer,controls;
      function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x020202);
        camera = new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,50000);
        camera.position.x = -250;
        camera.position.y = 310;
        camera.position.z = 800;
        controls = new THREE.OrbitControls(camera);
        controls.addEventListener('change', renderer);
        controls.panSpeed = 0.1;
        controls.rotateSpeed = 0.1;
        controls.update();
        let directionalLight = new THREE.DirectionalLight(0xffccaa,3);
        directionalLight.position.set(0,0,-1);
        scene.add(directionalLight);
        renderer = new THREE.WebGLRenderer({antialias:true});
        renderer.setSize(window.innerWidth,window.innerHeight);
        document.body.appendChild(renderer.domElement);
        let circleGeo = new THREE.CircleGeometry(220,50);
        let circleMat = new THREE.MeshBasicMaterial({color: 0xffccaa});
        let circle = new THREE.Mesh(circleGeo, circleMat);
        circle.position.set(0 ,100 ,-500);
        circle.scale.setX(1.2);
        scene.add(circle);
        let areaImage = new Image();
            areaImage.src = POSTPROCESSING.SMAAEffect.areaImageDataURL;
        let searchImage = new Image();
            searchImage.src = POSTPROCESSING.SMAAEffect.searchImageDataURL;
        let smaaEffect = new POSTPROCESSING.SMAAEffect(searchImage,areaImage,1);
        let godraysEffect = new POSTPROCESSING.GodRaysEffect(camera, circle, {
          resolutionScale: 1,
          density: 0.8,
          decay: 0.95,
          weight: 0.9,
          samples: 100
        });
        let renderPass = new POSTPROCESSING.RenderPass(scene, camera);
        let effectPass = new POSTPROCESSING.EffectPass(camera,godraysEffect);
        effectPass.renderToScreen = true;
        composer = new POSTPROCESSING.EffectComposer(renderer);
        composer.addPass(renderPass);
        composer.addPass(effectPass);
        let loader = new THREE.GLTFLoader();
        loader.load('model/batman_logo/scene.gltf', function(gltf){
          let bat = gltf.scene.children[0];
          bat.scale.set(100,100,100);
          scene.add(gltf.scene);
          animate();
        });
      }
      function animate() {
        composer.render(0.1);
        requestAnimationFrame(animate);
      }
      init();
    </script>
  </body>
</html>